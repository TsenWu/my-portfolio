<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>企業規模效益試算 (滑桿強化版)</title>
  <style>
    /* 1. 基礎重置 */
    body { margin: 0; padding: 0; background: transparent; font-family: "Microsoft JhengHei", Arial, sans-serif; overflow: hidden; }
    
    /* 2. 容器 */
    .calc-card {
      background-color: transparent;
      max-width: 90%;
      margin: 0 auto;
    }

    /* 3. 內容區 */
    .card-body { padding: 10px 5px; }

    /* 4. 滑桿控制區 */
    .control-group { margin-bottom: 25px; }
    
    .qty-label { 
      display: block; font-size: 16px; font-weight: 500; color: #334155; 
      margin-bottom: 15px; /* 增加一點間距讓滑塊不擁擠 */
      text-align: center;
    }
    .highlight-qty { color: #059669; font-weight: bold; font-size: 26px; margin-left: 5px; }
    
    /* ★★★ 滑桿樣式核心優化 ★★★ */
    input[type=range] { 
      -webkit-appearance: none; 
      width: 100%; 
      height: 16px; /* ★ 軌道加粗至 16px */
      background: #cbd5e1; /* ★ 軌道顏色加深 (深灰色) */
      border-radius: 10px; /* 軌道圓角 */
      outline: none; 
      cursor: pointer;
      transition: background 0.3s;
    }

    /* 滑塊樣式 (Chrome/Safari/Edge) */
    input[type=range]::-webkit-slider-thumb { 
      -webkit-appearance: none; 
      width: 32px; /* ★ 滑塊放大 */
      height: 32px; /* ★ 滑塊放大 */
      background: #059669; /* 金鍏綠 */
      border-radius: 50%; 
      cursor: grab;
      border: 4px solid #ffffff; /* ★ 加上白色邊框 */
      box-shadow: 0 4px 8px rgba(0,0,0,0.3); /* ★ 加上立體陰影 */
      margin-top: 0px; /* 對齊修正 */
      transition: transform 0.1s ease;
    }

    /* 滑鼠按住時的效果 */
    input[type=range]:active::-webkit-slider-thumb {
      cursor: grabbing;
      transform: scale(1.1); /* 按住時稍微放大，增加回饋感 */
      background: #047857;
    }
    
    /* 刻度文字 */
    .range-marks { 
      display: flex; justify-content: space-between; margin-top: 10px; 
      color: #64748b; font-size: 13px; font-weight: 500;
    }

    /* 5. 結果顯示區 */
    .result-box { background-color: #0f172a; border-radius: 16px; padding: 25px; text-align: center; position: relative; overflow: hidden; color: #fff; }
    .result-content { position: relative; z-index: 10; }
    .result-subtitle { color: #94a3b8; text-transform: uppercase; letter-spacing: 1px; font-size: 12px; font-weight: 600; margin: 0 0 5px 0; }
    .result-amount { font-size: 36px; font-weight: 900; color: #fff; margin-bottom: 10px; line-height: 1.1; }
    .result-desc-green { color: #34d399; font-weight: 500; font-size: 15px; margin: 0 0 5px 0; }
    .result-desc-small { color: #64748b; font-size: 12px; margin: 0; opacity: 0.8; }
    .bg-shimmer { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(90deg, transparent, rgba(16, 185, 129, 0.1), transparent); z-index: 1; }
  </style>
</head>
<body>

  <div class="calc-card">
    <div class="card-body">
      <div class="control-group">
        <label class="qty-label" for="gw-lamp-range">
          預計更換數量: <span id="gw-qty-display" class="highlight-qty">50</span> 盞
        </label>
        
        <input type="range" id="gw-lamp-range" min="1" max="200" step="1" value="50">
        
        <div class="range-marks">
          <span>1盞</span>
          <span>100盞</span>
          <span>200盞</span>
        </div>
      </div>

      <div class="result-box">
        <div class="result-content">
          <p class="result-subtitle">估算 5年 累積省下電費</p>
          <div class="result-amount">NTD <span id="gw-total-savings">65,625</span></div>
          <p class="result-desc-green">
             單盞省 $1,312.5 × <span id="gw-qty-text">50</span> 盞
          </p>
          <p class="result-desc-small">
             ( 基準：年用 3,000 小時 × $5/度 × 5 年 )
          </p>
        </div>
        <div class="bg-shimmer"></div>
      </div>
    </div>
  </div>

  <script>
    (function() {
      var rangeInput = document.getElementById('gw-lamp-range');
      var qtyDisplay = document.getElementById('gw-qty-display');
      var qtyText = document.getElementById('gw-qty-text');
      var totalSavingsDisplay = document.getElementById('gw-total-savings');
      var SAVING_PER_LAMP = 1312.5;

      function updateCalculator() {
        var quantity = parseInt(rangeInput.value);
        var total = quantity * SAVING_PER_LAMP;
        var formattedTotal = Math.floor(total).toLocaleString();

        qtyDisplay.textContent = quantity;
        qtyText.textContent = quantity;
        totalSavingsDisplay.textContent = formattedTotal;
      }

      if(rangeInput) {
        rangeInput.addEventListener('input', updateCalculator);
      }
    })();
  </script>
</body>
</html>
