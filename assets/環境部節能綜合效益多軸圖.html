<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LED 節能成效多軸互動圖表</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
    body {
      font-family: 'Inter', 'Noto Sans TC', sans-serif;
      background-color: #f7faf9;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      height: 100vh;
    }

    .chart-container {
      background: #fff;
      border-radius: 16px;
      padding: 20px 30px 16px 30px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
      width: 100%;
      max-width: 1200px;
      height: 90vh;
      box-sizing: border-box;
    }

    @media (max-width: 768px) {
      body {
        align-items: flex-start;
        padding: 16px;
        height: auto;
      }

      .chart-container {
        height: auto;
        padding: 16px 12px;
        border-radius: 12px;
      }

      canvas {
        height: 400px !important;
      }
    }
  </style>
</head>
<body>
  <div class="chart-container">
    <canvas id="combinedChart"></canvas>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const years = ['108年度', '109年度', '110年度', '111年度', '112年度', '113年度', '114年度'];
      const electricitySaved = [440264, 445118, 433235, 436012, 434758, 435498, 437099];
      const oilEquivalentSaved = [42.08, 42.53, 41.4, 41.67, 41.55, 41.62, 41.77];
      const co2EmissionsSaved = [243.91, 226.56, 220.52, 221.93, 215.21, 215.57, 216.36];

      const COLORS = {
        electricity: { border: '#5AA9E6', background: 'rgba(90,169,230,0.7)' },
        oil: { border: '#F4A261', background: 'rgba(244,162,97,0.4)' },
        co2: { border: '#2A9D8F', background: 'rgba(42,157,143,0.3)' }
      };

      const ctx = document.getElementById('combinedChart').getContext('2d');

      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: years,
          datasets: [
            {
              label: '節約耗能油當量 (Kloe/年)',
              data: oilEquivalentSaved,
              borderColor: COLORS.oil.border,
              backgroundColor: COLORS.oil.background,
              pointBackgroundColor: COLORS.oil.border,
              type: 'line',
              yAxisID: 'y-oil',
              tension: 0.4,
              fill: false,
              pointRadius: 5,
              pointHoverRadius: 7,
              order: 1,
              segment: { z: 100 }
            },
            {
              label: '節約CO₂排放量 (噸/年)',
              data: co2EmissionsSaved,
              borderColor: COLORS.co2.border,
              backgroundColor: COLORS.co2.background,
              pointBackgroundColor: COLORS.co2.border,
              type: 'line',
              yAxisID: 'y-co2',
              tension: 0.4,
              fill: false,
              pointRadius: 5,
              pointHoverRadius: 7,
              order: 2,
              segment: { z: 100 }
            },
            {
              label: '節約耗電量 (kWh/年)',
              data: electricitySaved,
              backgroundColor: COLORS.electricity.background,
              borderColor: COLORS.electricity.border,
              borderWidth: 1,
              yAxisID: 'y-electricity',
              order: 3
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          layout: {
            padding: {
              bottom: 10
            }
          },
          plugins: {
            legend: {
              position: 'top',
              labels: {
                font: { size: 13 },
                boxWidth: 20
              },
              generateLabels(chart) {
                const order = {
                  '節約耗電量 (kWh/年)': 1,
                  '節約耗能油當量 (Kloe/年)': 2,
                  '節約CO₂排放量 (噸/年)': 3
                };
                return Chart.defaults.plugins.legend.labels.generateLabels(chart)
                  .sort((a, b) => order[a.text] - order[b.text]);
              }
            },
            tooltip: {
              backgroundColor: 'rgba(10,25,41,0.9)',
              titleFont: { size: 13, weight: 'bold' },
              bodyFont: { size: 11 },
              padding: 8,
              cornerRadius: 8,
              mode: 'index',
              intersect: false
            }
          },
          scales: {
            x: {
              title: { display: false },
              ticks: { maxRotation: 45, minRotation: 45 },
              grid: { display: false }
            },
            'y-electricity': {
              type: 'linear',
              position: 'left',
              title: {
                display: true,
                text: '節約耗電量 (kWh/年)',
                font: { weight: 'bold', size: 13 },
                color: COLORS.electricity.border
              },
              min: 430000,
              grid: { drawOnChartArea: false },
              ticks: { color: COLORS.electricity.border, font: { size: 11 } }
            },
            'y-co2': {
              type: 'linear',
              position: 'right',
              title: {
                display: true,
                text: 'CO₂ 排放量 (噸/年)',
                font: { weight: 'bold', size: 13 },
                color: COLORS.co2.border
              },
              grid: { drawOnChartArea: false },
              ticks: { color: COLORS.co2.border, font: { size: 11 } }
            },
            'y-oil': {
              type: 'linear',
              position: 'right',
              title: {
                display: true,
                text: '耗能油當量 (Kloe/年)',
                font: { weight: 'bold', size: 13 },
                color: COLORS.oil.border
              },
              min: 41,
              max: 43,
              grid: { drawOnChartArea: false },
              ticks: { color: COLORS.oil.border, font: { size: 11 } }
            }
          }
        }
      });
    });
  </script>
</body>
</html>
