<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>環境部 LED 光板燈節能綜合效益多軸圖</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background-color: #f4f7f9;
        }
        /* Chart.js 提示框樣式調整 */
        .chartjs-tooltip {
            background: rgba(10, 25, 41, 0.9);
            border-radius: 0.5rem;
            padding: 0.5rem 0.75rem;
            color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="p-4 md:p-6"> <!-- 減少 body 的邊距 -->

    <div class="max-w-7xl mx-auto bg-white p-6 md:p-8 rounded-xl shadow-2xl"> <!-- 減少主容器的邊距 -->
        <!-- 主標題 (總頁面標題) -->
        <!-- 修正: 將 text-3xl 縮小到 text-2xl -->
        <h1 class="text-2xl font-extrabold text-gray-900 mb-2 border-b-4 border-gray-300 pb-2 text-center">
            環境部換裝金鍏LED光板燈 節能綜合效益多軸圖
        </h1>
        
        <!-- 上方區塊標題 -->
        <h2 class="text-xl text-gray-600 mb-4 mt-3 font-semibold text-center"> <!-- 減少 mb 和 mt -->
            七年節能總成效速覽 (108-114 年度)
        </h2>

        <!-- 統計數據提示框 -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6"> <!-- 減少 mb -->
            <!-- 1. 耗電量 -->
            <div class="bg-blue-50 border-t-4 border-[#5AA9E6] p-4 rounded-xl shadow-lg hover:shadow-xl transition duration-300 transform hover:scale-[1.01]"> <!-- 減少 p -->
                <p class="text-sm font-semibold text-gray-500 uppercase tracking-wider">七年節約耗電量 (總計)</p>
                <!-- 數字縮小至 text-3xl -->
                <p class="text-3xl font-extrabold text-gray-900 mt-1">3,061,984 <span class="text-lg font-bold text-[#5AA9E6]">度</span></p>
                <!-- 重點數字從 text-3xl 縮小到 text-2xl，保持紅色 -->
                <p class="text-lg font-extrabold text-gray-700 mt-2">省下高達 <span class="text-2xl text-red-600 font-extrabold">1,164 萬</span> 電費</p>
            </div>
            <!-- 2. 油當量 -->
            <div class="bg-amber-50 border-t-4 border-[#F4A261] p-4 rounded-xl shadow-lg hover:shadow-xl transition duration-300 transform hover:scale-[1.01]"> <!-- 減少 p -->
                <p class="text-sm font-semibold text-gray-500 uppercase tracking-wider">七年節約油當量 (總計)</p>
                 <!-- 數字縮小至 text-3xl -->
                <p class="text-3xl font-extrabold text-gray-900 mt-1">292.62 <span class="text-lg font-bold text-[#F4A261]">Kloe</span></p>
                <p class="text-sm text-gray-600 mt-2">約當於 <span class="font-bold">292,620 公升</span> 汽油當量</p>
            </div>
            <!-- 3. 碳排放量 -->
            <div class="bg-emerald-50 border-t-4 border-[#2A9D8F] p-4 rounded-xl shadow-lg hover:shadow-xl transition duration-300 transform hover:scale-[1.01]"> <!-- 減少 p -->
                <p class="text-sm font-semibold text-gray-500 uppercase tracking-wider">七年節約碳排放量 (總計)</p>
                 <!-- 數字縮小至 text-3xl -->
                <p class="text-3xl font-extrabold text-gray-900 mt-1">1,560.06 <span class="text-lg font-bold text-[#2A9D8F]">噸</span></p>
                <p class="text-sm text-gray-600 mt-2">相當於數萬棵樹的 <span class="font-bold">年吸收量</span></p>
            </div>
        </div>

        <!-- 下方區塊標題 (圖表標題) -->
        <h2 class="text-xl font-bold text-gray-700 mb-3 text-center"> <!-- 減少 mb -->
            年度節能三大指標趨勢分析
        </h2>
        
        <!-- 單一多軸圖表容器 -->
        <div class="bg-white p-4 rounded-lg shadow-xl border border-gray-200"> <!-- 減少 p -->
            <!-- 降低高度至 h-[340px] -->
            <div class="h-[340px] w-full"> 
                <canvas id="combinedChart"></canvas>
            </div>
        </div>
        
    </div>

    <script>
        // 原始數據
        const years = ['108年度', '109年度', '110年度', '111年度', '112年度', '113年度', '114年度'];
        const electricitySaved = [440264, 445118, 433235, 436012, 434758, 435498, 437099]; // 柱狀圖 (左軸)
        const oilEquivalentSaved = [42.08, 42.53, 41.4, 41.67, 41.55, 41.62, 41.77]; // 折線圖 (右軸 - 油當量)
        const co2EmissionsSaved = [243.91, 226.56, 220.52, 221.93, 215.21, 215.57, 216.36]; // 折線圖 (右軸 - 減碳量)

        // 定義新的顏色配置
        const COLORS = {
            electricity: {
                border: '#5AA9E6',
                background: 'rgba(90, 169, 230, 0.7)'
            },
            oil: {
                border: '#F4A261',
                background: 'rgba(244, 162, 97, 0.4)'
            },
            co2: {
                border: '#2A9D8F',
                background: 'rgba(42, 157, 143, 0.3)'
            }
        };

        window.onload = function() {
            const ctx = document.getElementById('combinedChart').getContext('2d');
            
            new Chart(ctx, {
                type: 'bar', // 基礎類型為柱狀圖
                data: {
                    labels: years,
                    datasets: [
                        {
                            label: '節約耗電量 (kWh/年)',
                            data: electricitySaved,
                            backgroundColor: COLORS.electricity.background,
                            borderColor: COLORS.electricity.border,
                            borderWidth: 1,
                            type: 'bar', // 設定為柱狀圖
                            yAxisID: 'y-electricity',
                            order: 2, // 確保柱狀圖在折線圖後繪製
                        },
                        {
                            label: '節約CO₂排放量 (噸/年)',
                            data: co2EmissionsSaved,
                            borderColor: COLORS.co2.border,
                            backgroundColor: COLORS.co2.background,
                            pointBackgroundColor: COLORS.co2.border,
                            type: 'line', // 設定為折線圖
                            yAxisID: 'y-co2',
                            tension: 0.4,
                            fill: false,
                            pointRadius: 5, // 縮小點的大小
                            pointHoverRadius: 7,
                            order: 1, // 確保折線圖在柱狀圖前繪製
                        },
                        {
                            label: '節約耗能油當量 (Kloe/年)',
                            data: oilEquivalentSaved,
                            borderColor: COLORS.oil.border,
                            backgroundColor: COLORS.oil.background,
                            pointBackgroundColor: COLORS.oil.border,
                            type: 'line', // 設定為折線圖
                            yAxisID: 'y-oil',
                            tension: 0.4,
                            fill: false,
                            pointRadius: 5, // 縮小點的大小
                            pointHoverRadius: 7,
                            order: 1, // 確保折線圖在柱狀圖前繪製
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                font: {
                                    size: 13 // 縮小圖例字體
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(10, 25, 41, 0.9)',
                            titleFont: { size: 13, weight: 'bold' }, // 縮小 tooltip 字體
                            bodyFont: { size: 11 }, 
                            padding: 8,
                            cornerRadius: 6,
                            mode: 'index',
                            intersect: false,
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: '年度',
                                font: { weight: 'bold', size: 13 }
                            },
                            grid: { display: false },
                            ticks: {
                                font: { size: 11 } // 縮小 X 軸刻度字體
                            }
                        },
                        // 左側 Y 軸：耗電量 (Bar)
                        'y-electricity': {
                            type: 'linear',
                            position: 'left',
                            title: {
                                display: true,
                                text: '節約耗電量 (kWh/年)',
                                font: { weight: 'bold', size: 12 }, // 縮小 Y 軸標題字體
                                color: COLORS.electricity.border 
                            },
                            min: 430000, 
                            grid: { drawOnChartArea: false },
                            ticks: { 
                                color: COLORS.electricity.border,
                                font: { size: 11 } // 縮小 Y 軸刻度字體
                            }
                        },
                        // 右側 Y 軸 1：CO₂ 排放量 (Line)
                        'y-co2': {
                            type: 'linear',
                            position: 'right',
                            title: {
                                display: true,
                                text: 'CO₂ 排放量 (噸/年)',
                                font: { weight: 'bold', size: 12 }, // 縮小 Y 軸標題字體
                                color: COLORS.co2.border 
                            },
                            grid: { drawOnChartArea: false },
                            ticks: { 
                                color: COLORS.co2.border,
                                font: { size: 11 } // 縮小 Y 軸刻度字體
                            }
                        },
                        // 右側 Y 軸 2：耗能油當量 (Line)
                        'y-oil': {
                            type: 'linear',
                            position: 'right',
                            title: {
                                display: true,
                                text: '耗能油當量 (Kloe/年)',
                                font: { weight: 'bold', size: 12 }, // 縮小 Y 軸標題字體
                                color: COLORS.oil.border 
                            },
                            min: 41, 
                            max: 43, 
                            grid: { drawOnChartArea: false },
                            ticks: { 
                                color: COLORS.oil.border,
                                font: { size: 11 } // 縮小 Y 軸刻度字體
                            }
                        }
                    }
                }
            });
        };
    </script>

</body>
</html>
